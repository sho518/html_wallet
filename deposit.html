<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<script src="https://code.jquery.com/jquery-latest.js "></script>
	<script type="text/javascript" src="./js/qrcode.js"></script>
	<script src="./js/jsQR.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script type="text/javascript" src="./js/web3.min.js"></script>
    <title>입금</title>
    <style>
        .container {
            max-width: 600px;
            margin: 0 auto;
        }

        /* 추가할 스타일 */
        .navigation {
            text-align: center;
            margin: 20px 0;
        }

        .navigation a {
            margin: 0 15px;
            text-decoration: none;
            color: #333;
        }

        .navigation a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
	<div class="container navigation">
		<a href="create_wallet.html">Create Wallet</a> | 
		<a href="transfer.html">Transfer</a> | 
		<a href="deposit.html">Deposit</a>
	</div>
	<hr>

	<div class="container">
		<h2><strong>Deposit</strong></h2>
		<h5>Deposit Address: <input id="fromaddress" size="45" readonly></input></h5>
		<h5>Balance: <span id="balance">0</span> ETH</h5>  <!-- 잔액을 표시할 부분 -->
		<div id="qrcode"></div>
	</div>



    <script>
		$(document).ready(function () {
			const web3 = new Web3('https://sepolia.infura.io/v3/be5b3b96d60e47ea926d52e0d99264e7');
			
			// localStorage에서 주소 가져오기
			const address = localStorage.getItem('accountAddress');
			
			// 주소가 있으면 #fromaddress 입력 필드에 설정
			if(address) {
				$('#fromaddress').val(address);
				
				// QR 코드 생성기를 사용하여 주소의 QR 코드 생성
				let qrcode = new QRCode(document.getElementById("qrcode"), {
					text: address,
					width: 128,
					height: 128,
					colorDark : "#000000",
					colorLight : "#ffffff",
					correctLevel : QRCode.CorrectLevel.H
				});
				// 잔액 조회 및 표시
				web3.eth.getBalance(address, function(error, wei) {
					if (!error) {
						const balanceInEth = web3.utils.fromWei(wei, 'ether');
						$('#balance').text(balanceInEth);
					}
				});
			}
		});

    </script>
</body>
</html>
